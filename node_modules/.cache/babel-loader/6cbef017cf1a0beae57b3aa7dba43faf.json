{"ast":null,"code":"import _slicedToArray from\"C:/Users/Admin/Desktop/\\u0412\\u044F\\u0447\\u0435\\u0441\\u043B\\u0430\\u0432/Projects/1479361-what-to-watch-9/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useRef,useState}from'react';import{useDispatch}from'react-redux';import{useNavigate,useParams}from'react-router-dom';import{APIRoute}from'../../const';import{useAppSelector}from'../../hooks';import{playOrPause}from'../../store/action';import NotFoundPage from'../not-found-page/not-found-page';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var secondsToHms=function secondsToHms(d){d=Number(d);var h=Math.floor(d/3600);var m=Math.floor(d%3600/60);var s=Math.floor(d%3600%60);var hDisplay=h>0?\"\".concat(h,\":\"):'';var mDisplay=m>0?\"\".concat(m,\":\"):'';var sDisplay=s>0?s:'';return\"\".concat(hDisplay,\" \").concat(mDisplay,\" \").concat(sDisplay);};var fullScreenHandle=function fullScreenHandle(){var element=document.querySelector('.player__video');if(element!==null&&element!==void 0&&element.requestFullscreen){return element===null||element===void 0?void 0:element.requestFullscreen();}};function PlayerPage(){var videoRef=useRef(null);var allFilms=useAppSelector(function(state){return state.allFilms;});var playPause=useAppSelector(function(state){return state.playOrPause;});var dispatch=useDispatch();var navigate=useNavigate();var _useParams=useParams(),id=_useParams.id;var dataFilm=allFilms.find(function(it){return it.id===Number(id);});var _useState=useState(0),_useState2=_slicedToArray(_useState,2),time=_useState2[0],setTime=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),duration=_useState4[0],setDuration=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),timeToogler=_useState6[0],setTimeToogler=_useState6[1];useEffect(function(){var timeOut=setTimeout(function(){if(videoRef.current){setTime(videoRef.current.currentTime);setDuration(videoRef.current.duration-time);setTimeToogler(time*100/videoRef.current.duration);}},1000);return function(){clearTimeout(timeOut);};},[time,duration,playPause]);if(!dataFilm){return/*#__PURE__*/_jsx(NotFoundPage,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"player\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,src:dataFilm.videoLink,className:\"player__video\",poster:dataFilm.posterImage}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return navigate(\"\".concat(APIRoute.Films,\"/\").concat(dataFilm.id));},type:\"button\",className:\"player__exit\",children:\"Exit\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"player__controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"player__controls-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"player__time\",children:[/*#__PURE__*/_jsx(\"progress\",{className:\"player__progress\",value:timeToogler,max:\"100\"}),/*#__PURE__*/_jsx(\"div\",{className:\"player__toggler\",style:{left:\"\".concat(timeToogler,\"%\")},children:\"Toggler\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"player__time-value\",children:secondsToHms(duration)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"player__controls-row\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){var _videoRef$current2;if(playPause){var _videoRef$current;dispatch(playOrPause(!playPause));return(_videoRef$current=videoRef.current)===null||_videoRef$current===void 0?void 0:_videoRef$current.pause();}dispatch(playOrPause(!playPause));return(_videoRef$current2=videoRef.current)===null||_videoRef$current2===void 0?void 0:_videoRef$current2.play();},type:\"button\",className:\"player__play\",children:[/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 19 19\",width:\"19\",height:\"19\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:\"\".concat(!playPause?'#play-s':'#pause')})}),/*#__PURE__*/_jsx(\"span\",{children:\"Play\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"player__name\",children:\"Transpotting\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return fullScreenHandle();},type:\"button\",className:\"player__full-screen\",children:[/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 27 27\",width:\"27\",height:\"27\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:\"#full-screen\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Full screen\"})]})]})]})]});}export default PlayerPage;","map":{"version":3,"sources":["C:/Users/Admin/Desktop/Вячеслав/Projects/1479361-what-to-watch-9/src/pages/player-page/player-page.tsx"],"names":["useEffect","useRef","useState","useDispatch","useNavigate","useParams","APIRoute","useAppSelector","playOrPause","NotFoundPage","secondsToHms","d","Number","h","Math","floor","m","s","hDisplay","mDisplay","sDisplay","fullScreenHandle","element","document","querySelector","requestFullscreen","PlayerPage","videoRef","allFilms","state","playPause","dispatch","navigate","id","dataFilm","find","it","time","setTime","duration","setDuration","timeToogler","setTimeToogler","timeOut","setTimeout","current","currentTime","clearTimeout","videoLink","posterImage","Films","left","pause","play"],"mappings":"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","sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { APIRoute } from '../../const';\nimport { useAppSelector } from '../../hooks';\nimport { playOrPause } from '../../store/action';\nimport NotFoundPage from '../not-found-page/not-found-page';\n\nconst secondsToHms = (d: number) => {\n  d = Number(d);\n  const h = Math.floor(d / 3600);\n  const m = Math.floor(d % 3600 / 60);\n  const s = Math.floor(d % 3600 % 60);\n\n  const hDisplay = h > 0 ? `${h}:` : '';\n  const mDisplay = m > 0 ? `${m}:` : '';\n  const sDisplay = s > 0 ? s : '';\n  return `${hDisplay} ${mDisplay} ${sDisplay}`;\n};\n\nconst fullScreenHandle = () => {\n  const element = document.querySelector('.player__video');\n  if(element?.requestFullscreen){\n    return element?.requestFullscreen();\n  }\n};\n\nfunction PlayerPage() {\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const allFilms = useAppSelector((state) => state.allFilms);\n  const playPause = useAppSelector((state) => state.playOrPause);\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const {id} = useParams();\n  const dataFilm = allFilms.find((it) => it.id === Number(id));\n\n  const [time, setTime] = useState((0));\n  const [duration, setDuration] = useState(0);\n  const [timeToogler, setTimeToogler] = useState(0);\n\n  useEffect(() => {\n    const timeOut = setTimeout(() => {\n      if(videoRef.current){\n        setTime(videoRef.current.currentTime);\n        setDuration(videoRef.current.duration - time);\n        setTimeToogler(time * 100 / videoRef.current.duration);\n      }\n    }, 1000);\n\n    return () => {\n      clearTimeout(timeOut);\n    };\n  }, [time, duration, playPause]);\n\n  if(!dataFilm){\n    return <NotFoundPage/>;\n  }\n  return (\n    <div className=\"player\">\n\n      <video ref={videoRef} autoPlay src={dataFilm.videoLink} className=\"player__video\" poster={dataFilm.posterImage}></video>\n      <button onClick={() => navigate(`${APIRoute.Films}/${dataFilm.id}`)} type=\"button\" className=\"player__exit\">Exit</button>\n\n      <div className=\"player__controls\">\n        <div className=\"player__controls-row\">\n          <div className=\"player__time\">\n            <progress className=\"player__progress\" value={timeToogler} max='100'></progress>\n            <div className=\"player__toggler\" style={{left: `${timeToogler}%` }}>Toggler</div>\n          </div>\n          <div className=\"player__time-value\">{secondsToHms(duration)}</div>\n        </div>\n        <div className=\"player__controls-row\">\n          <button onClick={ () => {\n            if(playPause){\n              dispatch(playOrPause(!playPause));\n              return videoRef.current?.pause();\n            }\n            dispatch(playOrPause(!playPause));\n            return videoRef.current?.play();\n          } }\n          type=\"button\" className=\"player__play\"\n          >\n            <svg viewBox=\"0 0 19 19\" width=\"19\" height=\"19\">\n              <use xlinkHref={`${!playPause? '#play-s': '#pause'}`}></use>\n            </svg>\n            <span>Play</span>\n          </button>\n          <div className=\"player__name\">Transpotting</div>\n\n          <button onClick={() => fullScreenHandle()} type=\"button\" className=\"player__full-screen\">\n            <svg viewBox=\"0 0 27 27\" width=\"27\" height=\"27\">\n              <use xlinkHref=\"#full-screen\"></use>\n            </svg>\n            <span>Full screen</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default PlayerPage;\n"]},"metadata":{},"sourceType":"module"}